{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:base"],

  // Schedule: Run nightly
  "schedule": ["after 10pm and before 5am"],
  "timezone": "UTC",

  // Auto-merge if CI passes
  "automerge": true,
  "automergeType": "pr",
  "automergeStrategy": "squash",
  "platformAutomerge": true,

  // Custom regex managers for RPM packages
  "regexManagers": [
    {
      // Track flightctl-agent RPM package versions
      "fileMatch": ["^.*bootc/Containerfile.*$"],
      "matchStrings": [
        // Match: dnf install flightctl-agent or dnf install flightctl-agent-X.Y.Z
        "dnf -y install flightctl-agent(?:-(?<currentValue>[0-9]+\\.[0-9]+\\.[0-9]+(?:-[0-9]+)?))?"
      ],
      "depNameTemplate": "flightctl-agent",
      "packageNameTemplate": "flightctl/flightctl",
      "datasourceTemplate": "github-releases",
      "versioningTemplate": "semver",
      "extractVersionTemplate": "^v(?<version>.*)$"
    }
  ],

  // Package rules
  "packageRules": [
    {
      // Group GitHub Actions updates
      "matchManagers": ["github-actions"],
      "groupName": "GitHub Actions",
      "automerge": true
    },
    {
      // Track base container images in Containerfiles
      "matchManagers": ["dockerfile"],
      "matchFiles": ["**/bootc/Containerfile*"],
      "groupName": "bootc base images",
      "automerge": true
    },
    {
      // Track flightctl-agent RPM package
      "matchManagers": ["regex"],
      "matchPackageNames": ["flightctl/flightctl"],
      "groupName": "flightctl-agent",
      "automerge": true
    }
  ],

  // Dockerfile-specific settings
  "dockerfile": {
    "enabled": true,
    // Track versioned base images (e.g., centos-bootc:stream9)
    "versioning": "docker"
  },

  // GitHub Actions
  "github-actions": {
    "enabled": true
  },

  // PR settings
  "prConcurrentLimit": 3,
  "prCreation": "immediate",
  "prHourlyLimit": 0,

  // Branch protection
  "requiredStatusChecks": null,

  // Labels
  "labels": ["dependencies", "renovate"]
}
